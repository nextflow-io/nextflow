!function(){var t=d3.scale.category20c().domain(d3.range(0,20)).range();var n="#bdbdbd";d3.timeline=function(){var e=["circle","rect"],r=function(){},i=function(){},a=function(){},o=function(){},c=function(){},l=function(t){return t},u=function(){},s=function(){},f="bottom",g=null,h=null,d=null,m=null,p={format:d3.time.format("%I %p"),tickTime:d3.time.hours,tickInterval:1,tickSize:6},x=d3.scale.category20(),v=null,w="rect",k=0,y=0,_=0,T={left:30,right:30,top:30,bottom:30},b=!1,F=!1,B=!1,A=!1,E=20,S=5,I=60,Y=!0,z=!1,M=!1,C=!1,O={stroke:"stroke-dasharray",spacing:"4 10"},H={marginTop:25,marginBottom:0,width:1,color:x},L=!1,R={marginTop:25,marginBottom:0,width:1,color:x},j=!1,D=!1,N=!1,P="white",W={},q=function(t){var n=T.left-I,e=(g-T.left)/6,r=g-T.right-e+I,i=t.append("g").attr("class","axis").attr("transform","translate(0, 20)");N&&function(t){var n=k.getFullYear();k.getFullYear()!=_.getFullYear()&&(n=k.getFullYear()+"-"+_.getFullYear()),t.append("text").attr("transform","translate(20, 0)").attr("x",0).attr("y",14).attr("class","calendarYear").text(n)}(i),i.append("text").attr("transform","translate("+n+", 0)").attr("x",0).attr("y",14).attr("class","chevron").text("<").on("click",(function(){return u(k,W)})),i.append("text").attr("transform","translate("+r+", 0)").attr("x",0).attr("y",14).attr("class","chevron").text(">").on("click",(function(){return s(_,W)}))},G=function(t,n,e){t.insert("rect").attr("class","row-green-bar").attr("x",n).attr("width",g).attr("y",e).attr("height",E).attr("fill",P)};function J(e){var u=e.append("g"),s=e[0][0].getBoundingClientRect(),x=d3.select(e[0][0]),v={},I=1,N=0,P=0;!function(){if(g||s.width){if(!g||!s.width)try{g=x.attr("width")}catch(t){console.log(t)}}else try{if(!(g=x.attr("width")))throw"width of the timeline is not set. As of Firefox 27, timeline().with(x) needs to be explicitly set in order to render"}catch(t){console.log(t)}}(),B&&u.each((function(t,n){t.forEach((function(t,n){t.times.forEach((function(t,e){0===n&&0===e?(originTime=t.starting_time,t.starting_time=0,t.ending_time=t.ending_time-originTime):(t.starting_time=t.starting_time-originTime,t.ending_time=t.ending_time-originTime)}))}))})),(b||0===_||0===k)&&(u.each((function(t,n){t.forEach((function(t,n){b&&-1==Object.keys(v).indexOf(n)&&(v[n]=I,I++),t.times.forEach((function(t,n){0===k&&(t.starting_time<N||0===N&&!1===B)&&(N=t.starting_time),0===_&&t.ending_time>P&&(P=t.ending_time)}))}))})),0===_&&(_=P),0===k&&(k=N));var J=1/(_-k)*(g-T.left-T.right),K=d3.time.scale().domain([k,_]).range([T.left,g-T.right]),Q=d3.svg.axis().scale(K).orient(f).tickFormat(p.format).ticks(p.numTicks||p.tickTime,p.tickInterval).tickSize(p.tickSize);u.each((function(c,s){W=c,c.forEach((function(c,s){var f=c.cached,h=c.index,p=c.times,x=void 0!==c.label;if(void 0!==c.id&&console.warn("d3Timeline Warning: Ids per dataset is deprecated in favor of a 'class' key. Ids are now per data element."),m&&function(t,n,e,r,i){var a=(E+S)*t[n]+T.top;e.selectAll("svg").data(r).enter().insert("rect").attr("class","row-green-bar").attr("x",A?0:T.left).attr("width",A?g:g-T.right-T.left).attr("y",a).attr("height",E).attr("fill",m instanceof Function?m(i,n):m)}(v,s,u,p,c),u.selectAll("svg").data(p).enter().append((function(t,n){return document.createElementNS(d3.ns.prefix.svg,"display"in t?t.display:w)})).attr("x",$).attr("y",_).attr("width",(function(t,n){return(t.ending_time-t.starting_time)*J})).attr("cy",(function(t,n){return _(t,n)+E/2})).attr("cx",$).attr("r",E/2).attr("height",E).style("fill",(function(e,r){return 0==r?n:1==r?f?"#9c9c9c":function(n){return t[n%16]}(h):n})).on("mousemove",(function(t,n){r(t,s,c)})).on("mouseover",(function(t,n){i(t,n,c)})).on("mouseout",(function(t,n){a(t,n,c)})).on("click",(function(t,n){o(t,s,c)})).attr("class",(function(t,n){return c.class?"timelineSeries_"+c.class:"timelineSeries_"+s})).attr("id",(function(t,n){return c.id&&!t.id?"timelineItem_"+c.id:t.id?t.id:"timelineItem_"+s+"_"+n})),u.selectAll("svg").data(p).enter().append("text").attr("x",tt).attr("y",(function(t,n){if(b)return T.top+(E+S)*v[s]+.75*E;return T.top+.75*E})).text((function(t){return t.label})),d){var k=E+S/2+T.top+(E+S)*v[s];e.append("svg:line").attr("class","row-seperator").attr("x1",0+T.left).attr("x2",g-T.right).attr("y1",k).attr("y2",k).attr("stroke-width",1).attr("stroke",d)}function _(t,n){return b?T.top+(E+S)*v[s]:T.top}x&&function(t,n,e,r,i){var a=E+S,c=T.top+a/2+a*(n[e]||1);t.append("text").attr("class","timeline-label").attr("transform","translate("+y+","+c+")").text(r?l(i.label):i.id).on("click",(function(t,n){o(t,e,i)}))}(e,v,s,x,c),void 0!==c.icon&&e.append("image").attr("class","timeline-label").attr("transform","translate(0,"+(T.top+(E+S)*v[s])+")").attr("xlink:href",c.icon).attr("width",T.left).attr("height",E)}))}));var U=T.top+(E+S)*I,V=T.top;if(Y&&function(t,n,e){j&&G(t,0,0),D&&q(t),t.append("g").attr("class","axis").attr("transform","translate(0,"+e+")").call(n)}(u,Q,z?V:U),C&&function(t,n,e){t.append("g").attr("class","axis").attr("transform","translate(0,"+(T.top+(E+S)*e)+")").attr(O.stroke,O.spacing).call(n.tickFormat("").tickSize(-(T.top+(E+S)*(e-1)+3),0,0))}(u,Q,I),g>s.width){var X=d3.behavior.zoom().x(K).on("zoom",(function(){var t=Math.min(0,Math.max(s.width-g,d3.event.translate[0]));X.translate([t,0]),u.attr("transform","translate("+t+",0)"),c(t*J,K)}));e.attr("class","scrollable").call(X)}F&&u.selectAll(".tick text").attr("transform",(function(t){return"rotate("+F+")translate("+(this.getBBox().width/2+10)+","+this.getBBox().height/2+")"}));var Z=u[0][0].getBoundingClientRect();(function(){if(h||x.attr("height"))h?x.attr("height",h):h=x.attr("height");else{if(!E)throw"height of the timeline is not set";h=Z.height+Z.top-s.top,d3.select(e[0][0]).attr("height",h)}}(),L&&u.each((function(t,n){t.forEach((function(t){t.times.forEach((function(t){nt(K(t.starting_time),R),nt(K(t.ending_time),R)}))}))})),M)&&nt(K(new Date),H);function $(t,n){return T.left+(t.starting_time-k)*J}function tt(t,n){return T.left+(t.starting_time-k)*J+5}function nt(t,n){e.append("svg:line").attr("x1",t).attr("y1",n.marginTop).attr("x2",t).attr("y2",h-n.marginBottom).style("stroke",n.color).style("stroke-width",n.width)}}return J.margin=function(t){return arguments.length?(T=t,J):T},J.orient=function(t){return arguments.length?(f=t,J):f},J.itemHeight=function(t){return arguments.length?(E=t,J):E},J.itemMargin=function(t){return arguments.length?(S=t,J):S},J.navMargin=function(t){return arguments.length?(I=t,J):I},J.height=function(t){return arguments.length?(h=t,J):h},J.width=function(t){return arguments.length?(g=t,J):g},J.display=function(t){return arguments.length&&-1!=e.indexOf(t)?(w=t,J):w},J.labelFormat=function(t){return arguments.length?(l=t,J):null},J.tickFormat=function(t){return arguments.length?(p=t,J):p},J.hover=function(t){return arguments.length?(r=t,J):r},J.mouseover=function(t){return arguments.length?(i=t,J):t},J.mouseout=function(t){return arguments.length?(a=t,J):t},J.click=function(t){return arguments.length?(o=t,J):o},J.scroll=function(t){return arguments.length?(c=t,J):c},J.colors=function(t){return arguments.length?(x=t,J):x},J.beginning=function(t){return arguments.length?(k=t,J):k},J.ending=function(t){return arguments.length?(_=t,J):_},J.labelMargin=function(t){return arguments.length?(y=t,J):_},J.rotateTicks=function(t){return F=t,J},J.stack=function(){return b=!b,J},J.relativeTime=function(){return B=!B,J},J.showBorderLine=function(){return L=!L,J},J.showBorderFormat=function(t){return arguments.length?(R=t,J):R},J.showToday=function(){return M=!M,J},J.showTodayFormat=function(t){return arguments.length?(H=t,J):H},J.colorProperty=function(t){return arguments.length?(v=t,J):v},J.rowSeperators=function(t){return arguments.length?(d=t,J):d},J.background=function(t){return arguments.length?(m=t,J):m},J.showTimeAxis=function(){return Y=!Y,J},J.showAxisTop=function(){return z=!z,J},J.showAxisCalendarYear=function(){return N=!N,J},J.showTimeAxisTick=function(){return C=!C,J},J.fullLengthBackgrounds=function(){return A=!A,J},J.showTimeAxisTickFormat=function(t){return arguments.length?(O=t,J):O},J.showAxisHeaderBackground=function(t){return j=!j,t&&(P=t),J},J.navigate=function(t,n){return u=t,s=n,D=!D,J},J}}();